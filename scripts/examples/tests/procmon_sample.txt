bph@bph-controller:~/bph-framework/scripts/examples/tools$ python3 procmon_sample.py ~/bph-framework/misc/bph_upx.exe 

            ____  __    ___   ________ __ ____  __  _________   _______  __
           / __ )/ /   /   | / ____/ //_// __ \/ / / / ____/ | / /  _/ |/ /
          / __  / /   / /| |/ /   / ,<  / /_/ / /_/ / __/ /  |/ // / |   / 
         / /_/ / /___/ ___ / /___/ /| |/ ____/ __  / /___/ /|  // / /   |  
        /_____/_____/_/  |_\____/_/ |_/_/   /_/ /_/_____/_/ |_/___//_/|_|
                                                             -=[v.1.0.0]=-
                                                              
                    MALWARE ANALYSIS + AUTOMATION FRAMEWORK
                   
                Developed by Chris Navarrete @ FortiGuard Labs
              
                       Copyright (c) 2019 Fortinet, Inc.
                       
                     Contact: bph_framework@fortinet.com               
        
2019-09-25 10:01:33,632|INFO|bph.core.session| Setting sample: /home/bph/bph-framework/misc/bph_upx.exe
2019-09-25 10:01:33,633|INFO|bph.core.session| Session ID: 5842f66b-1856-4292-ad86-bc72d0b78937
2019-09-25 10:01:33,633|INFO|bph.core.session| Starting session: blackhat_arsenal_2019
2019-09-25 10:01:33,634|INFO|bph.core.server.template| Initializing BLACKPHENIX C&C Template Server...
2019-09-25 10:01:33,634|INFO|bph.core.server.template| Socket Ready
2019-09-25 10:01:33,634|INFO|bph.core.server.template| Starting server listener..
2019-09-25 10:01:33,634|INFO|bph.core.server.template| Accepting new connections now....
2019-09-25 10:01:33,642|INFO|bph.tools.windows.procmon| Config file path: /home/bph/bph-framework/plugins/basic/dynamic/procmon/x86/3.10/procmon.json
2019-09-25 10:01:33,643|INFO|bph.tools.windows.procmon| STARTING PROCMON
2019-09-25 10:01:33,643|INFO|bph.tools.windows.procmon| Executing Template
2019-09-25 10:01:33,949|INFO|bph.core.server.template| Agent connected: ('192.168.56.1', 55726)
2019-09-25 10:01:35,653|INFO|bph.tools.windows.procmon| Agent is Connected. Delivering Template now...
2019-09-25 10:01:35,658|INFO|bph.tools.windows.procmon| {'module_name': 'bph.tools.windows.procmon', 'sid': '5842f66b-1856-4292-ad86-bc72d0b78937', 'md5': '53d4d29384354bf74c2fb2b4f8996d04', 'project_name': 'blackhat_arsenal_2019', 'rid': '9852d2c2-3be5-4809-83ce-43febb6e1a5c', 'tool_drive': 'H:\\', 'tool_name': 'procmon', 'arch': 'x86', 'version': '3.10', 'tool_directory': '/home/bph/bph-framework/plugins/basic/dynamic/procmon/x86', 'remote_tool_path': 'basic\\dynamic\\procmon\\x86\\3.10', 'template': <Box: {'name': 'ProcMon', 'description': 'ProcMon plugin'}>, 'tool': <Box: {'filename': 'procmon.exe', 'version': '3.10', 'type': 'console'}>, 'configuration': <Box: {'execution': {'admin_required': False, 'background_run': True, 'download_sample': False, 'custom_user_vars': {}, 'delay': 10}, 'reporting': {'report_files': False}}>, 'actions': <Box: {'action': 'capture', 'capture': {'description': '', 'parameters': '/Quiet /AcceptEula /BackingFile @report_folder@\\files\\procmon.pml /LoadConfig @tool_path@\\noisereduction.pmc', 'automation': None}, 'export': {'description': '', 'parameters': '/Quiet /AcceptEula /OpenLog @report_folder@\\files\\procmon.pml /SaveAs2 @report_folder@\\files\\procmon.xml /SaveApplyFilter', 'automation': None}, 'terminate': {'description': '', 'parameters': '/Terminate', 'automation': None}}>}
2019-09-25 10:01:35,662|INFO|bph.tools.windows.procmon| Waiting to deliver template...
2019-09-25 10:01:35,963|INFO|bph.core.server.template| Sending template...
2019-09-25 10:01:35,964|INFO|bph.core.server.template| Waiting response from client...
2019-09-25 10:01:40,666|INFO|bph.tools.windows.procmon| Waiting to deliver template...
2019-09-25 10:01:45,674|INFO|bph.tools.windows.procmon| Waiting to deliver template...
2019-09-25 10:01:46,212|INFO|bph.core.server.template| Template was delivered correctly
2019-09-25 10:01:50,682|INFO|bph.tools.windows.procmon| Template has been delivered.
2019-09-25 10:01:50,683|INFO|bph.tools.windows.procmon| Next instruction will be sent in (10) seconds
2019-09-25 10:02:00,772|INFO|bph.tools.windows.nircmd| Config file path: /home/bph/bph-framework/plugins/basic/dynamic/nircmd/x86/2.85/nircmd.json
2019-09-25 10:02:00,773|INFO|bph.tools.windows.nircmd| STARTING PROCESS
2019-09-25 10:02:00,774|INFO|bph.tools.windows.nircmd| Executing Template
2019-09-25 10:02:02,776|INFO|bph.tools.windows.nircmd| Agent is Connected. Delivering Template now...
2019-09-25 10:02:02,781|INFO|bph.tools.windows.nircmd| {'module_name': 'bph.tools.windows.nircmd', 'sid': '5842f66b-1856-4292-ad86-bc72d0b78937', 'md5': '53d4d29384354bf74c2fb2b4f8996d04', 'project_name': 'blackhat_arsenal_2019', 'rid': '71fcdd5d-826a-4c1a-b429-fd3faac47603', 'tool_drive': 'H:\\', 'tool_name': 'nircmd', 'arch': 'x86', 'version': '2.85', 'tool_directory': '/home/bph/bph-framework/plugins/basic/dynamic/nircmd/x86', 'remote_tool_path': 'basic\\dynamic\\nircmd\\x86\\2.85', 'template': <Box: {'name': 'NirCmd', 'description': 'NirCmd plugin'}>, 'tool': <Box: {'filename': 'nircmdc.exe', 'version': '2.85', 'type': 'console'}>, 'configuration': <Box: {'execution': {'admin_required': False, 'background_run': False, 'download_sample': True, 'custom_user_vars': {'program': '@sample@'}, 'delay': 0}, 'reporting': {'report_files': False}}>, 'actions': <Box: {'kill_process': {'description': 'Kills a target process', 'parameters': 'killprocess @program@', 'automation': None}, 'start_process': {'description': 'Starts a target process', 'parameters': 'exec show @program@', 'automation': None}, 'action': 'start_process'}>, 'download_url': 'http://192.168.56.90:8194/bph/session/blackhat_arsenal_2019/launcher/bph_upx.exe'}
2019-09-25 10:02:02,782|INFO|bph.tools.windows.nircmd| Waiting to deliver template...
2019-09-25 10:02:03,313|INFO|bph.core.server.template| Sending template...
2019-09-25 10:02:03,314|INFO|bph.core.server.template| Waiting response from client...
2019-09-25 10:02:04,568|INFO|bph.core.server.template| Template was delivered correctly
2019-09-25 10:02:07,785|INFO|bph.tools.windows.nircmd| Template has been delivered.
2019-09-25 10:02:07,786|INFO|bph.tools.windows.nircmd| Next instruction will be sent in (0) seconds
2019-09-25 10:02:07,786|INFO|bph.tools.windows.procmon| TERMINATING PROCMON
2019-09-25 10:02:07,787|INFO|bph.tools.windows.procmon| Executing Template
2019-09-25 10:02:09,794|INFO|bph.tools.windows.procmon| Agent is Connected. Delivering Template now...
2019-09-25 10:02:09,799|INFO|bph.tools.windows.procmon| {'module_name': 'bph.tools.windows.procmon', 'sid': '5842f66b-1856-4292-ad86-bc72d0b78937', 'md5': '53d4d29384354bf74c2fb2b4f8996d04', 'project_name': 'blackhat_arsenal_2019', 'rid': '9852d2c2-3be5-4809-83ce-43febb6e1a5c', 'tool_drive': 'H:\\', 'tool_name': 'procmon', 'arch': 'x86', 'version': '3.10', 'tool_directory': '/home/bph/bph-framework/plugins/basic/dynamic/procmon/x86', 'remote_tool_path': 'basic\\dynamic\\procmon\\x86\\3.10', 'template': <Box: {'name': 'ProcMon', 'description': 'ProcMon plugin'}>, 'tool': <Box: {'filename': 'procmon.exe', 'version': '3.10', 'type': 'console'}>, 'configuration': <Box: {'execution': {'admin_required': False, 'background_run': False, 'download_sample': False, 'custom_user_vars': {}, 'delay': 15}, 'reporting': {'report_files': False}}>, 'actions': <Box: {'action': 'terminate', 'capture': {'description': '', 'parameters': '/Quiet /AcceptEula /BackingFile @report_folder@\\files\\procmon.pml /LoadConfig @tool_path@\\noisereduction.pmc', 'automation': None}, 'export': {'description': '', 'parameters': '/Quiet /AcceptEula /OpenLog @report_folder@\\files\\procmon.pml /SaveAs2 @report_folder@\\files\\procmon.xml /SaveApplyFilter', 'automation': None}, 'terminate': {'description': '', 'parameters': '/Terminate', 'automation': None}}>}
2019-09-25 10:02:09,800|INFO|bph.tools.windows.procmon| Waiting to deliver template...
2019-09-25 10:02:10,593|INFO|bph.core.server.template| Sending template...
2019-09-25 10:02:10,593|INFO|bph.core.server.template| Waiting response from client...
2019-09-25 10:02:14,806|INFO|bph.tools.windows.procmon| Waiting to deliver template...
2019-09-25 10:02:19,813|INFO|bph.tools.windows.procmon| Waiting to deliver template...
2019-09-25 10:02:24,817|INFO|bph.tools.windows.procmon| Waiting to deliver template...
2019-09-25 10:02:25,814|INFO|bph.core.server.template| Template was delivered correctly
2019-09-25 10:02:29,821|INFO|bph.tools.windows.procmon| Template has been delivered.
2019-09-25 10:02:29,821|INFO|bph.tools.windows.procmon| Next instruction will be sent in (15) seconds
2019-09-25 10:02:44,837|INFO|bph.tools.windows.procmon| EXPORTING PROCMON RESULTS
2019-09-25 10:02:44,838|INFO|bph.tools.windows.procmon| Executing Template
2019-09-25 10:02:46,840|INFO|bph.tools.windows.procmon| Agent is Connected. Delivering Template now...
2019-09-25 10:02:46,841|INFO|bph.tools.windows.procmon| {'module_name': 'bph.tools.windows.procmon', 'sid': '5842f66b-1856-4292-ad86-bc72d0b78937', 'md5': '53d4d29384354bf74c2fb2b4f8996d04', 'project_name': 'blackhat_arsenal_2019', 'rid': '9852d2c2-3be5-4809-83ce-43febb6e1a5c', 'tool_drive': 'H:\\', 'tool_name': 'procmon', 'arch': 'x86', 'version': '3.10', 'tool_directory': '/home/bph/bph-framework/plugins/basic/dynamic/procmon/x86', 'remote_tool_path': 'basic\\dynamic\\procmon\\x86\\3.10', 'template': <Box: {'name': 'ProcMon', 'description': 'ProcMon plugin'}>, 'tool': <Box: {'filename': 'procmon.exe', 'version': '3.10', 'type': 'console'}>, 'configuration': <Box: {'execution': {'admin_required': False, 'background_run': False, 'download_sample': False, 'custom_user_vars': {}, 'delay': 10}, 'reporting': {'report_files': True}}>, 'actions': <Box: {'action': 'export', 'capture': {'description': '', 'parameters': '/Quiet /AcceptEula /BackingFile @report_folder@\\files\\procmon.pml /LoadConfig @tool_path@\\noisereduction.pmc', 'automation': None}, 'export': {'description': '', 'parameters': '/Quiet /AcceptEula /OpenLog @report_folder@\\files\\procmon.pml /SaveAs2 @report_folder@\\files\\procmon.xml /SaveApplyFilter', 'automation': None}, 'terminate': {'description': '', 'parameters': '/Terminate', 'automation': None}}>}
2019-09-25 10:02:46,842|INFO|bph.tools.windows.procmon| Waiting to deliver template...
2019-09-25 10:02:46,859|INFO|bph.core.server.template| Sending template...
2019-09-25 10:02:46,860|INFO|bph.core.server.template| Waiting response from client...
2019-09-25 10:02:51,847|INFO|bph.tools.windows.procmon| Waiting to deliver template...
2019-09-25 10:02:56,858|INFO|bph.tools.windows.procmon| Waiting to deliver template...
2019-09-25 10:02:59,021|INFO|bph.core.server.template| Template was delivered correctly
2019-09-25 10:03:01,863|INFO|bph.tools.windows.procmon| Template has been delivered.
2019-09-25 10:03:01,863|INFO|bph.tools.windows.procmon| Next instruction will be sent in (10) seconds
2019-09-25 10:03:16,877|INFO|bph.tools.windows.procmon| Searching for files now in: /home/bph/bph-framework/session/blackhat_arsenal_2019/53d4d29384354bf74c2fb2b4f8996d04/5842f66b-1856-4292-ad86-bc72d0b78937/procmon/9852d2c2-3be5-4809-83ce-43febb6e1a5c
2019-09-25 10:03:16,878|INFO|bph.tools.windows.procmon| File: procmon.xml
2019-09-25 10:03:16,879|INFO|bph.tools.windows.procmon| File: procmon.pml
bph@bph-controller:~/bph-framework/scripts/examples/tools$ 

